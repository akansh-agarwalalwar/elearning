# Logging System Documentation

This directory contains all the log files generated by the e-learning application. The logging system is designed to track all important events, operations, and errors for monitoring and debugging purposes.

## üìÅ Log Files

### 1. **auth.log**
- **Purpose**: Authentication and authorization events
- **Content**: Login attempts, registration, token validation, security events
- **Example**: `2024-01-01 10:30:15 - auth - INFO - AUTH LOGIN: instructor1 - SUCCESS | User type: instructor`

### 2. **courses.log**
- **Purpose**: Course-related operations
- **Content**: Course creation, updates, deletions, access attempts
- **Example**: `2024-01-01 10:35:20 - courses - INFO - COURSE CREATE: 550e8400-e29b-41d4-a716-446655440000 | Instructor: 1 | Title: Python Programming`

### 3. **users.log**
- **Purpose**: User management operations
- **Content**: User creation, profile access, user deletions
- **Example**: `2024-01-01 10:40:25 - users - INFO - USER CREATE: 1 | Type: instructor | Email: instructor@example.com`

### 4. **errors.log**
- **Purpose**: Error tracking and debugging
- **Content**: Application errors, exceptions, failed operations
- **Example**: `2024-01-01 10:45:30 - errors - ERROR - ERROR COURSE_CREATION_FAILED: Database connection failed | User: 1 | Duration: 0.150s`

### 5. **general.log**
- **Purpose**: General application events and API requests
- **Content**: API requests, performance metrics, system events
- **Example**: `2024-01-01 10:50:35 - general - INFO - API Request: POST /api/v1/instructor/courses/create | User: authenticated_user | Status: 201 | Duration: 0.125s`

## üîß Log Configuration

### Log Rotation
- **Max file size**: 10MB per log file
- **Backup count**: 5 backup files per log type
- **Format**: `filename.log.1`, `filename.log.2`, etc.

### Log Levels
- **INFO**: Normal operations and events
- **WARNING**: Security events and potential issues
- **ERROR**: Errors and exceptions
- **DEBUG**: Detailed debugging information (when enabled)

### Log Format
```
Timestamp - Logger Name - Level - Message
2024-01-01 10:30:15 - auth - INFO - AUTH LOGIN: username - SUCCESS
```

## üìä Monitoring and Analysis

### Key Metrics to Monitor

1. **Authentication Events**
   - Successful vs failed login attempts
   - Registration success rates
   - Security violations

2. **Course Operations**
   - Course creation frequency
   - Most active instructors
   - Course access patterns

3. **Performance Metrics**
   - API response times
   - Slow requests (> 1 second)
   - Database operation performance

4. **Error Tracking**
   - Common error types
   - Error frequency by endpoint
   - User impact of errors

### Log Analysis Commands

```bash
# Count authentication events
grep "AUTH LOGIN" logs/auth.log | wc -l

# Find failed login attempts
grep "AUTH LOGIN.*FAILED" logs/auth.log

# Check for slow requests
grep "PERFORMANCE.*took.*[2-9]\." logs/general.log

# Monitor course creation
grep "COURSE CREATE" logs/courses.log

# Track errors by type
grep "ERROR" logs/errors.log | cut -d' ' -f6 | sort | uniq -c
```

## üö® Alerting and Monitoring

### Critical Events to Monitor

1. **Security Events**
   - Multiple failed login attempts
   - Unauthorized access attempts
   - Suspicious user behavior

2. **Performance Issues**
   - Requests taking > 2 seconds
   - High error rates
   - Database connection issues

3. **System Health**
   - Application startup/shutdown
   - Database connection status
   - Memory usage patterns

### Recommended Monitoring Setup

1. **Real-time Log Monitoring**
   ```bash
   tail -f logs/errors.log
   tail -f logs/auth.log | grep "FAILED"
   ```

2. **Daily Log Analysis**
   ```bash
   # Count daily events
   date=$(date +%Y-%m-%d)
   grep "$date" logs/general.log | wc -l
   ```

3. **Weekly Performance Review**
   ```bash
   # Find slowest requests of the week
   grep "PERFORMANCE" logs/general.log | sort -k4 -n | tail -10
   ```

## üîç Debugging with Logs

### Common Debugging Scenarios

1. **User Registration Issues**
   ```bash
   grep "REGISTRATION_FAILED" logs/errors.log
   grep "REGISTER.*FAILED" logs/auth.log
   ```

2. **Course Creation Problems**
   ```bash
   grep "COURSE_CREATION_FAILED" logs/errors.log
   grep "COURSE CREATE" logs/courses.log
   ```

3. **Authentication Problems**
   ```bash
   grep "LOGIN_FAILED" logs/errors.log
   grep "AUTH LOGIN.*FAILED" logs/auth.log
   ```

4. **Performance Issues**
   ```bash
   grep "PERFORMANCE.*took.*[1-9]\." logs/general.log
   ```

## üìà Log Retention Policy

- **Current logs**: Keep for 30 days
- **Backup logs**: Keep for 90 days
- **Archived logs**: Compress and store for 1 year
- **Critical errors**: Keep indefinitely

## üõ†Ô∏è Maintenance

### Log Cleanup Script
```bash
#!/bin/bash
# Clean up old log files (older than 30 days)
find logs/ -name "*.log.*" -mtime +30 -delete
```

### Log Compression
```bash
# Compress old logs
find logs/ -name "*.log.*" -mtime +7 -exec gzip {} \;
```

## üìù Best Practices

1. **Regular Monitoring**: Check logs daily for errors and performance issues
2. **Log Rotation**: Ensure log rotation is working properly
3. **Backup Strategy**: Regularly backup log files for analysis
4. **Security**: Protect log files from unauthorized access
5. **Performance**: Monitor log file sizes and disk usage

## üîó Integration

The logging system integrates with:
- **FastAPI middleware**: Automatic request logging
- **Database operations**: CRUD operation tracking
- **Authentication system**: Login/registration events
- **Course management**: All course-related operations
- **Error handling**: Comprehensive error tracking

For more information about the logging configuration, see `config/logging_config.py`. 